<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Damian Oswald">
<meta name="dcterms.date" content="2023-09-29">

<title>Open Government Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="README.md"><i class="bi bi-file-code"></i>Github (GFM)</a></li><li><a href="Open-Government-Data.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<!-- 
  This is the default Quarto title block header (customize as required) 
  Learn more about Pandoc template syntax here: https://pandoc.org/MANUAL.html#templates
-->

<header id="title-block-header">
  <h1 id="title">Open Government Data</h1>
  <div id="page-properties">
    <div class="details">
      <div>Created By Author</div>
      <div>Yesterday at 12:00 PM • 8 min read</div>
    </div>
  </div>
</header>


<p>“The world’s most valuable resource is no longer oil, but data” – at least that’s how <em>The Economist</em> phrased it in an article in 2017 <span class="citation" data-cites="economist2017">(<a href="#ref-economist2017" role="doc-biblioref"><em>1</em></a>)</span>. But is that true? There are certainly good reasons to support this metaphor. Much like oil, data can also be seen as a raw material – and as a raw material they are worthless unless processed.</p>
<p>However, there is the argument that data could be viewed more like an infrastructure than oil in the sense that it provides the fundamental framework or system needed for things to function. This could be in the context of operations, processes or even economies. Data, like infrastructure, is essential for information flow, decision making, and overall functioning in today’s digital era. And, unlike oil, which is consumed and needs to be replenished, data can be used repeatedly. Seeing data as a sort of infrastructure is used as an argument that its publication should be a responsibility of the state — in the form of open government data <span class="citation" data-cites="fedlex2018">(<a href="#ref-fedlex2018" role="doc-biblioref"><em>2</em></a>)</span>.</p>
<p>Open government data (OGD) refers to the idea that data collected and generated by government entities should be freely accessible to the public, excluding information that compromises privacy and security. This type of data is often used as a means to promote transparency and accountability in government, enable public participation, and drive economic growth through the development of new apps, products, and services. It also offers potential for innovation by providing raw material for research, as well as the basis for planning in areas like transport, healthcare, or environmental policy.</p>
<section id="some-principles-behind-ogd" class="level1">
<h1>Some principles behind OGD</h1>
<section id="the-fair-principle" class="level2">
<h2 class="anchored" data-anchor-id="the-fair-principle">The FAIR principle</h2>
<p>OGD should be FAIR. The latter stands for <strong>F</strong>indability, <strong>A</strong>ccessibility, <strong>I</strong>nteroperability, and <strong>R</strong>euse. <em>Findability</em> means that data have a unique and persistent identification. For example, personal data should be given identification numbers (ID) that can be uniquely assigned to individuals. Furthermore, datasets should be described with <em>metadata</em>. <em>Accessibility</em> refers to the principle that data are freely available via a URL. If data is protected, then at least their metadata should be published. <em>Interoperability</em> refers to the publication of data and metadata in a known (and widespread) format. Lastly, by <em>Reuse</em>, we mean that the provenance of data is indicated, the data is always provided with data usage license and is retrievable in a sensible size.</p>
</section>
<section id="the-five-star-system" class="level2">
<h2 class="anchored" data-anchor-id="the-five-star-system">The five-star system</h2>
<p>Not all open data are of the same quality – <em>all OGD are open, but some are more open than others</em>. In 2010, Sir Tim Berners-Lee suggested a 5-star ranking for open data. The data get more stars as proprietary formats are removed and links are added (<a href="#tbl-stars">table&nbsp;1</a>).</p>
<div id="tbl-stars" class="anchored">
<table class="table">
<caption>Table&nbsp;1: The five-star system according to Tim Berners-Lee. The more stars, the more <em>open</em> the published data is.</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 69%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Stars</th>
<th style="text-align: left;">Idea</th>
<th style="text-align: left;">Example format</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\star\)</span></td>
<td style="text-align: left;">Make your stuff available on the web under an open license (no matter the format)</td>
<td style="text-align: left;"><code>PDF</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(\star\star\)</span></td>
<td style="text-align: left;">Make it available as structured data (e.g., Excel instead of image scan of a table)</td>
<td style="text-align: left;"><code>XLS</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\star\star\star\)</span></td>
<td style="text-align: left;">Make it available in a non-proprietary open format (e.g., CSV instead of Excel)</td>
<td style="text-align: left;"><code>CSV</code>, <code>JSON</code>, <code>XML</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(\star\star\star\star\)</span></td>
<td style="text-align: left;">Use URIs to denote things, so that people can point at your stuff</td>
<td style="text-align: left;"><code>RDF</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\star\star\star\star\star\)</span></td>
<td style="text-align: left;">Link your data to other data to provide context</td>
<td style="text-align: left;"><code>LOD</code></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="open-standards" class="level2">
<h2 class="anchored" data-anchor-id="open-standards">Open standards</h2>
<p>For data to be truly open, it is not enough that it is accessible. The format also needs to follow an <em>open standard</em>, that is, a standard that is widely used, internationally accepted, consensus-based, in the public domain and clearly defined. Importantly, metadata, i.e., data about the data, should also follow that open standard. Examples of that are <em>Dublin Core</em>, <em>Schema.org</em>, or <em>DCAT</em>.</p>
</section>
<section id="interoperability" class="level2">
<h2 class="anchored" data-anchor-id="interoperability">Interoperability</h2>
<p>Interoperability is the ability of independent, heterogeneous computer systems to work together as seamlessly as possible in order to exchange information in an efficient and usable manner, and to make it available to the user without the need for special agreements between the systems. For this, compliance with common standards is necessary.</p>
</section>
</section>
<section id="data-owner-custodian-and-steward" class="level1">
<h1>Data owner, custodian and steward</h1>
<p>The roles of data owners, data custodians, and data stewards, all play critical parts in the management and governance of data, but their responsibilities are distinct:</p>
<ol type="1">
<li><p><strong>Data Owner:</strong> This is usually a member of management who has legal authority and control over some data. They are responsible for the security and quality of the data and for determining who should have access to the information. They must also ensure compliance with relevant legal and regulatory requirements.</p></li>
<li><p><strong>Data Custodian:</strong> The data custodian is typically responsible for the technical environment and operations needed to protect and maintain data. These responsibilities may include data storage, retrieval, archival, or purging. The data custodian ensures data is managed and protected, execute the access decisions made by the data owner, and maintain the data’s technical infrastructure.</p></li>
<li><p><strong>Data Steward:</strong> The data steward ensures the quality and usability of the data. They concern themselves with data standards, data definitions, data quality metrics, and business metadata. They serve as a bridge between data owners (who decide the policies) and data custodians (who implement the policies) by making sure that data is reliable, understood, and used correctly <span class="citation" data-cites="plotkin2020data">(<a href="#ref-plotkin2020data" role="doc-biblioref"><em>3</em></a>)</span>.</p></li>
</ol>
</section>
<section id="the-swiss-ogd-ecosystem" class="level1">
<h1>The Swiss OGD ecosystem</h1>
<p>Switzerland passed the Freedom of Information Act and Regulation (<em>Öffentlichkeitsgesetz, Öffentlichkeitsverordnung</em>) on July 1, 2006. These laws state, that anybody has the right to get access to non-protected governmental documents <span class="citation" data-cites="fedlex2004">(<a href="#ref-fedlex2004" role="doc-biblioref"><em>4</em></a>)</span>. Although that was a first step towards a more transparent government, it’s not open government data. The <a href="https://www.parldigi.ch">parliamentary group for digital sustainability</a> (Parldigi), founded in 2009, is concerned with promoting concepts such as open source software, open standards, open data, open access, open content, open internet, open government in parliament. Outside of parliament, the association <a href="https://opendata.ch/">opendata.ch</a>, founded in 2011, has been committed to strengthening transparency, participation and innovation in Switzerland with respect to data.</p>
<p>The legal framework around OGD recently experienced renewal with the OGD strategy Switzerland 2019-2023 <span class="citation" data-cites="fedlex2018">(<a href="#ref-fedlex2018" role="doc-biblioref"><em>2</em></a>)</span>. This strategy creates a business office OGD within the federal statistical office responsible with its implementation. Goal is the targeted publication of government data at a high quality. For this purpose, the meta data platform <a href="https://opendata.swiss">opendata.swiss</a> is created. Supporting that strategy, the federal law on the use of electronic means for the fulfillment of official duties (EMBAG), which is expected to come into effect in the beginning of 2024, will force all governmental software and data to be published <em>by default</em> <span class="citation" data-cites="fedlex2023">(<a href="#ref-fedlex2023" role="doc-biblioref"><em>5</em></a>)</span>. Specifically, the law states:</p>
<blockquote class="blockquote">
<p><strong>Art. 10</strong> Open Government Data</p>
<p><sup>1</sup> <em>Die diesem Gesetz unterstehenden Verwaltungseinheiten machen ihre Daten, die sie zur Erfüllung ihrer gesetzlichen Aufgaben beschaffen oder generieren und die elektronisch gespeichert und in Sammlungen strukturiert vorliegen, öffentlich zugänglich.</em></p>
</blockquote>
<p>However, there are many exceptions to that law, such that finding excuses not to publish data for governmental bodies will remain relatively easy. In addition, the data protection act states that for the publication of <em>personal data</em>, i.e., data referring to any legal entity, a special legal basis is required – thus, personal data are specifically exempt from the EMBAG <span class="citation" data-cites="fedlex2023dsg">(<a href="#ref-fedlex2023dsg" role="doc-biblioref"><em>6</em></a>)</span>.</p>
<section id="how-to-anonymize-personal-data" class="level2">
<h2 class="anchored" data-anchor-id="how-to-anonymize-personal-data">How to anonymize personal data</h2>
<p>Personal data may only be published if it is anonymized. One such method for anonymization is <span class="math inline">\(k\)</span>-anonymity. Its protocol was developed in 1998 by Samarati and Sweeney <span class="citation" data-cites="samarati1998protecting">(<a href="#ref-samarati1998protecting" role="doc-biblioref"><em>7</em></a>)</span>. The (basic) algorithm to determine the degree of anonymity <span class="math inline">\(k\)</span> of some personal data is relatively simple. In R, it could be written as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>K <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(D))</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(D)) {</span>
<span id="cb1-3"><a href="#cb1-3"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(D)) {</span>
<span id="cb1-4"><a href="#cb1-4"></a>      <span class="cf">if</span>(i<span class="sc">==</span>j) <span class="cf">next</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>      <span class="cf">if</span>(<span class="fu">all</span>(D[i,qi]<span class="sc">==</span>D[j,qi])) K[j] <span class="ot">&lt;-</span> K[j]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>   }</span>
<span id="cb1-7"><a href="#cb1-7"></a>}</span>
<span id="cb1-8"><a href="#cb1-8"></a>k <span class="ot">&lt;-</span> <span class="fu">min</span>(K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, <code>K</code> is the number of identical entries found for an observation in the data set <code>D</code>, while <code>k</code> is the minimum of vector <code>K</code>. The vector <code>qi</code> contains variable names of the quasi-identifiers. Standard personal data should only be published when <span class="math inline">\(k \geq 20\)</span>, and sensitive personal data only if <span class="math inline">\(k \geq 50\)</span>.</p>
</section>
</section>
<section id="the-impact-of-open-government-data" class="level1">
<h1>The impact of open government data</h1>
<p>Open government data can have all sorts of benefits. This includes (but is not limited to) the following:</p>
<ol type="1">
<li><p><strong>Transparency:</strong> Open government data allows for greater transparency in public administration. It enables citizens to see what decisions are being made and how resources are being allocated. This may build trust, as citizens can see the rationale behind policies and decisions, and helps to hold government officials accountable.</p></li>
<li><p><strong>Innovation:</strong> Open data can be used by individuals or organizations to create innovative solutions and services. As such, it can foster entrepreneurship and stimulate economic growth.</p></li>
<li><p><strong>Sustainability:</strong> Open government data can be useful in academic research, and may be used as a resource in education, both for teaching and learning. Students can analyze real data for projects or assignments. It also encourages citizen participation and engagement in government processes by enabling more informed discussions and debates.</p></li>
<li><p><strong>Efficiency:</strong> Open data fosters collaboration between different government entities, as well as between governments and citizens, nonprofits, businesses, etc. This can generally lead to a more efficient and attractive government administration.</p></li>
</ol>
<p>This all sounds great. However, individual governmental bodies need to know what their specific goals are, i.e., why they are publishing data. And ideally, they should (quantitatively) measure the impact in that regard, for example by applying the social return on investment approach <span class="citation" data-cites="stuermer2016measuring">(<a href="#ref-stuermer2016measuring" role="doc-biblioref"><em>8</em></a>)</span>. Unfortunately, determining causal effects like this is very difficult. It might be much more straightforward to pose surrogate questions: What businesses rely on the open data? How many research papers were published using the data? How often was the data used by journalists? Did the transparency lead to any citizen participation? So really, we are interested in the intermediaries, the entities using the open data, rather than their final effects.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Open government data represents a significant opportunity to foster transparency, accountability, innovation and citizen participation in governance. It also bolsters economic growth and encourages data-driven policy making. In Switzerland, laws start to come into effect that specifically promote open government data. However, for OGD to be truly open (in spirit), some concepts such as FAIR, the five-star system, interoperability and open standards need to be followed. Also, it’s crucial for governments to clearly define their OGD goals and assess their impact, ensuring that the data is effectively serving its intended purpose and benefiting society.</p>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-economist2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">The Economist, The world’s most valuable resource is no longer oil, but data (2017).</div>
</div>
<div id="ref-fedlex2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Schweizerische Eidgenossenschaft, <span class="nocase">Strategie f<span class="nocase">ü</span>r offene Verwaltungsdaten in der Schweiz 2019-2023 (Open-Government-Data-Strategie, OGD-Strategie)</span> (2018), (available at <a href="https://fedlex.data.admin.ch/eli/fga/2019/125">https://fedlex.data.admin.ch/eli/fga/2019/125</a>).</div>
</div>
<div id="ref-plotkin2020data" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">D. Plotkin, <em><a href="https://doi.org/10.1016/C2012-0-07057-3">Data stewardship: An actionable guide to effective data management and data governance</a></em> (Academic press, 2020).</div>
</div>
<div id="ref-fedlex2004" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Schweizerische Eidgenossenschaft, <span class="nocase">Bundesgesetz <span class="nocase">ü</span>ber das <span>Ö</span>ffentlichkeitsprinzip der Verwaltung (<span>Ö</span>ffentlichkeitsgesetz, BG<span>Ö</span>)</span> (2004), (available at <a href="https://fedlex.data.admin.ch/eli/fga/2004/1275">https://fedlex.data.admin.ch/eli/fga/2004/1275</a>).</div>
</div>
<div id="ref-fedlex2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Schweizerische Eidgenossenschaft, <span class="nocase">Bundesgesetz <span class="nocase">ü</span>ber den Einsatz elektronischer Mittel zur Erf<span class="nocase">ü</span>llung von Beh<span class="nocase">ö</span>rdenaufgaben (EMBAG)</span> (2023), (available at <a href="https://fedlex.data.admin.ch/eli/fga/2023/787">https://fedlex.data.admin.ch/eli/fga/2023/787</a>).</div>
</div>
<div id="ref-fedlex2023dsg" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Schweizerische Eidgenossenschaft, <span class="nocase">Bundesgesetz <span class="nocase">ü</span>ber den Datenschutz (Datenschutzgesetz, DSG)</span> (2023), (available at <a href="https://fedlex.data.admin.ch/eli/cc/2022/491">https://fedlex.data.admin.ch/eli/cc/2022/491</a>).</div>
</div>
<div id="ref-samarati1998protecting" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">P. Samarati, L. Sweeney, Protecting privacy when disclosing information: K-anonymity and its enforcement through generalization and suppression (1998).</div>
</div>
<div id="ref-stuermer2016measuring" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline"><a href="https://doi.org/10.1109/CeDEM.2016.31">M. Stuermer, M. M. Dapp, in <em>2016 conference for e-democracy and open government (CeDEM)</em> (IEEE, 2016), pp. 197–203</a>.</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>